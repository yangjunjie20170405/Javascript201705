{"version":3,"sources":["server.js"],"names":[],"mappings":"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","file":"server-compiled.js","sourcesContent":["var http = require(\"http\");\nvar fs = require(\"fs\");\nvar url = require(\"url\");\nvar server = http.createServer(function (req,res) {\n    // 这个回调函数 ，每一次请求都会执行一次\n    var urlObj = url.parse(req.url,true);\n    var pathname = urlObj[\"pathname\"];\n    var query = urlObj[\"query\"]; //加true {username:niu,password:123}\n    var reg = /\\.(HTML|JS|CSS|JSON|ICO)/i;// 忽略大小写\n    if(reg.test(pathname)){\n        // console.log(reg.exec(pathname))\n        var suffix = reg.exec(pathname)[1].toUpperCase();// 转换成大写\n        var suffixMIME = \"text/plain\";\n        switch(suffix){\n            case \"HTML\":\n                suffixMIME = \"text/html\";\n                break;\n            case \"CSS\":\n                suffixMIME = \"text/css\";\n                break;\n            case \"JS\":\n                suffixMIME = \"text/javascript\";\n                break;\n            case \"JSON\":\n                suffixMIME = \"application/json\";\n                break;\n            case \"ICO\":\n                suffixMIME = \"application/octet-stream\";\n                break;\n        }\n        try{\n            var conFile = fs.readFileSync(\".\"+pathname,\"utf-8\");\n            //设置响应头\n            res.writeHead(200,{'content-type':suffixMIME+';charset=utf-8;'})\n            res.end(conFile)\n        }catch(e){\n            res.writeHead(404,{'content-type':'text/plain;charset=utf-8;'})\n            res.end(\"request file is not found\")\n        }\n    }\n\n    var customPath = \"./json/custom.json\";\n    var con = fs.readFileSync(customPath,\"utf-8\");\n    con = JSON.parse(con);\n    var result = {code:1,msg:\"\",data:null}\n    //  1、获取所有的客户信息\n    if(pathname === \"/getList\"){\n        if(con.length>0){\n            result = {\n                code: 0,\n                msg:\"成功\",\n                data:con\n            }\n        }\n        console.log(con)\n        res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8\"})\n        res.end(JSON.stringify(result));\n        return;\n    }\n    // 根据传递进来客户的ID去获取某一个客户的信息\n   if(pathname === \"/getInfo\"){\n       var customId = query[\"id\"];\n       for(var i=0;i<con.length;i++){\n           if(con[i][\"id\"] == customId){\n               result = {\n                   code:0,\n                   msg : \"成功\",\n                   data:con[i]\n               }\n               break;\n           }\n       }\n       res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8\"})\n       res.end(JSON.stringify(result))\n       return;\n   };\n\n    // 3、根据当前传进来客户ID去删除这个客户\n    if(pathname === \"/removeInfo\"){\n        customId = query[\"id\"];\n        console.log(customId)\n        var flag = false;\n        for(var i=0;i<con.length;i++){\n            if(con[i][\"id\"] == customId){\n                con.splice(i,1);\n                flag = true;\n                break;\n            }\n        }\n        result.msg = \"删除失败\";\n        if(flag){\n            fs.writeFileSync(customPath,JSON.stringify(con),\"utf-8\");\n            result = {\n                code :0,\n                msg:\"删除成功\"\n            }\n        }\n        res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8;\"});\n        res.end(JSON.stringify(result))\n        return;\n    }\n    // 4) 增加客户信息\n    if(pathname === \"/addInfo\"){\n        var str = \"\";\n        req.on(\"data\",function (chunk) {\n            str += chunk;\n        });\n        req.on(\"end\",function () {\n            console.log(str)\n            //str = '{\"name\":\"\",\"age\":\"\".....}'\n            if(str.length === 0){\n                res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8;\"})\n                res.end(JSON.stringify({\n                    code : 1,\n                    msg:\"新增失败\"\n                }));\n                return;\n            }\n            var data = JSON.parse(str);\n            data[\"id\"]  =con.length===0?1: parseFloat(con[con.length-1][\"id\"])+1;\n            con.push(data);\n\n            fs.writeFileSync(customPath,JSON.stringify(con),\"utf-8\");\n            res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8;\"})\n            res.end(JSON.stringify({\n                code:0,\n                msg : \"新增成功\"\n            }));\n        });\n        return;\n    };\n    // 5)修改客户\n    if(pathname === \"/updateInfo\"){\n        var str = \"\";\n        req.on(\"data\",function (chunk) {\n            str+=chunk;\n        });\n        req.on(\"end\",function () {\n            if(str.length ===0){\n                res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8;\"})\n                res.end(JSON.stringify({\n                    code:1,\n                    msg : \"修改失败\"\n                }));\n                return;\n            };\n            var data = JSON.parse(str);\n            var flag = false;\n            for(var i=0;i<con.length;i++){\n                if(con[i][\"id\"] === data[\"id\"]){\n                    con[i] = data;\n                    flag = true;\n                    break;\n                }\n            }\n            result.msg = \"修改失败\";\n            if(flag){\n                fs.writeFileSync(customPath,JSON.stringfy(con),\"utf-8\");\n                result = {\n                    code : 0,\n                    msg: \"修改成功\"\n                }\n            }\n            res.writeHead(200,{\"content-type\":\"application/json;charset=utf-8;\"})\n            res.end(JSON.stringify(result));\n\n        });\n        return;\n    }\n});\n//监听服务\nserver.listen(80,function () {\n    console.log(\"当前80端口已经监听成功\")\n})"]}